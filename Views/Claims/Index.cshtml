@model IEnumerable<CMCS.Models.ViewModels.ClaimViewModel>
@{
    ViewData["Title"] = "My Claims";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="pt-3 pb-2 mb-3 border-bottom d-flex justify-content-between align-items-center">
    <h1 class="h2">My Claims</h1>
    <a href="@Url.Action("Create", "Claims")" class="btn btn-primary">
        <i class="fas fa-plus-circle me-2"></i>Submit New Claim
    </a>
</div>

<!-- Filter Options -->
<div class="row mb-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-body">
                <form method="get" class="row g-3">
                    <div class="col-md-3">
                        <label class="form-label">Status</label>
                        <select name="status" class="form-select">
                            <option value="">All Statuses</option>
                            <option value="Pending">Pending</option>
                            <option value="Approved">Approved</option>
                            <option value="Rejected">Rejected</option>
                            <option value="Paid">Paid</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Month</label>
                        <select name="month" class="form-select">
                            <option value="">All Months</option>
                            <option value="1">January</option>
                            <option value="2">February</option>
                            <option value="3">March</option>
                            <option value="4">April</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">August</option>
                            <option value="9">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Year</label>
                        <select name="year" class="form-select">
                            <option value="">All Years</option>
                            <option value="2025">2025</option>
                            <option value="2024">2024</option>
                            <option value="2023">2023</option>
                        </select>
                    </div>
                    <div class="col-md-3 d-flex align-items-end">
                        <button type="submit" class="btn btn-outline-primary me-2">
                            <i class="fas fa-filter me-1"></i>Filter
                        </button>
                        <a href="@Url.Action("Index")" class="btn btn-outline-secondary">
                            <i class="fas fa-times me-1"></i>Clear
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Claims Table -->
<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="fas fa-file-alt me-2"></i>All Claims</h5>
                <div>
                    <button class="btn btn-sm btn-outline-success">
                        <i class="fas fa-download me-1"></i>Export
                    </button>
                </div>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Claim Reference</th>
                                <th>Month/Year</th>
                                <th>Module</th>
                                <th>Hours</th>
                                <th>Rate</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Submitted</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model != null && Model.Any())
                            {
                                @foreach (var claim in Model)
                                {
                                    <tr>
                                        <td><strong>@claim.ClaimReference</strong></td>
                                        <td>@claim.MonthYear</td>
                                        <td>@claim.ModuleTaught</td>
                                        <td>@claim.HoursWorked h</td>
                                        <td>R@claim.HourlyRate.ToString("N2")</td>
                                        <td><strong>R@claim.TotalAmount.ToString("N2")</strong></td>
                                        <td>
                                            <span class="badge @(claim.Status == "Pending" ? "bg-warning" :
                                                                 claim.Status == "Approved" ? "bg-success" :
                                                                 claim.Status == "Paid" ? "bg-info" : "bg-danger") status-badge">
                                                @claim.Status
                                            </span>
                                        </td>
                                        <td>@claim.SubmissionDate.ToString("yyyy-MM-dd")</td>
                                        <td>
                                            <div class="btn-group">
                                                <a href="@Url.Action("Details", "Claims", new { id = claim.Id })" class="btn btn-sm btn-outline-primary">
                                                    <i class="fas fa-eye"></i> View
                                                </a>
                                                @if (claim.Status == "Pending")
                                                {
                                                    <a href="@Url.Action("Edit", "Claims", new { id = claim.Id })" class="btn btn-sm btn-outline-warning">
                                                        <i class="fas fa-edit"></i> Edit
                                                    </a>
                                                }
                                            </div>
                                        </td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <!-- Sample data for demo -->
                                <tr>
                                    <td><strong>CLM-20250315-7432</strong></td>
                                    <td>March 2025</td>
                                    <td>PROG6212 - Programming 2B</td>
                                    <td>45h</td>
                                    <td>R100.00</td>
                                    <td><strong>R4,500.00</strong></td>
                                    <td><span class="badge bg-warning status-badge">Pending</span></td>
                                    <td>2025-03-15</td>
                                    <td>
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-outline-primary">
                                                <i class="fas fa-eye"></i> View
                                            </button>
                                            <button class="btn btn-sm btn-outline-warning">
                                                <i class="fas fa-edit"></i> Edit
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>CLM-20250215-5621</strong></td>
                                    <td>February 2025</td>
                                    <td>WEDE6021 - Web Development</td>
                                    <td>38h</td>
                                    <td>R100.00</td>
                                    <td><strong>R3,800.00</strong></td>
                                    <td><span class="badge bg-success status-badge">Approved</span></td>
                                    <td>2025-02-15</td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-primary">
                                            <i class="fas fa-eye"></i> View
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>CLM-20250115-3421</strong></td>
                                    <td>January 2025</td>
                                    <td>DATA6222 - Database Design</td>
                                    <td>42h</td>
                                    <td>R100.00</td>
                                    <td><strong>R4,200.00</strong></td>
                                    <td><span class="badge bg-info status-badge">Paid</span></td>
                                    <td>2025-01-15</td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-primary">
                                            <i class="fas fa-eye"></i> View
                                        </button>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

@if (Model == null || !Model.Any())
{
    <div class="text-center mt-4">
        <div class="alert alert-info">
            <h5><i class="fas fa-info-circle me-2"></i>No Claims Found</h5>
            <p class="mb-0">You haven't submitted any claims yet. <a href="@Url.Action("Create", "Claims")">Submit your first claim</a> to get started.</p>
        </div>
    </div>
}